# 管理员系统设置指南

## 🎯 功能概述

管理员系统提供了完整的商家和活动管理功能，包括：
- **商家管理**：查看所有商家信息，设置事件数量限制
- **活动管理**：监控所有商家创建的活动
- **邀请码系统**：生成和管理商家注册邀请码
- **数据统计**：实时查看平台数据

## 🔑 管理员登录

### 默认管理员账户
- **邮箱**: `admin@partytix.com`
- **密码**: `admin123`

### 登录步骤
1. 访问 `http://localhost:3000/admin/login`
2. 输入管理员凭据
3. 进入管理员仪表板

## 👥 商家管理功能

### 查看所有商家
- 在管理员仪表板中点击 "Merchants" 标签
- 查看所有注册商家的详细信息
- 包括：姓名、邮箱、商家名称、事件数量限制

### 设置事件数量限制
- 为每个商家设置最大可创建事件数
- 输入数字或留空表示无限制
- 实时更新限制

### 商家状态管理
- **激活/停用**：控制商家账户状态
- **停用商家**：无法登录和创建事件
- **激活商家**：恢复正常功能

## 🎫 活动管理功能

### 查看所有活动
- 在管理员仪表板中点击 "Events" 标签
- 查看所有商家创建的活动
- 包括：活动名称、创建商家、收入统计、票务销售情况

### 活动数据统计
- **总收入**：所有活动的收入总和
- **票务销售**：已售票务数量
- **活动状态**：活动进行状态

## 🔑 邀请码系统

### 生成邀请码
1. 在管理员仪表板中点击 "Invite Codes" 标签
2. 点击 "Generate New Code" 按钮
3. 系统自动生成唯一邀请码

### 邀请码特性
- **唯一性**：每个邀请码都是唯一的
- **有效期**：默认30天有效期
- **使用限制**：每个邀请码只能使用一次
- **事件限制**：可设置商家最大事件数量

### 邀请码管理
- **查看状态**：已使用/未使用
- **使用记录**：查看哪个商家使用了邀请码
- **过期时间**：自动过期处理

## 📊 数据统计

### 总览数据
- **商家总数**：注册商家数量
- **活动总数**：创建的活动数量
- **总收入**：平台总收入统计
- **活跃邀请码**：可用的邀请码数量

### 实时更新
- 数据实时同步
- 自动刷新统计信息
- 支持多标签页同步

## 🛡️ 安全特性

### 管理员权限
- **超级管理员**：完整系统访问权限
- **安全登录**：密码哈希存储
- **会话管理**：自动登录状态检查

### 数据保护
- **本地存储**：所有数据存储在localStorage
- **数据隔离**：商家只能访问自己的数据
- **权限控制**：严格的访问权限管理

## 🔧 技术实现

### 管理员认证
```javascript
// 管理员登录验证
const admin = ADMIN_ACCOUNTS.find(acc => acc.email === email)
const isValidPassword = await bcrypt.compare(password, admin.password_hash)
```

### 邀请码生成
```javascript
// 生成唯一邀请码
const code = `INV_${Date.now().toString(36).toUpperCase()}_${Math.random().toString(36).substr(2, 6).toUpperCase()}`
```

### 商家注册验证
```javascript
// 验证邀请码
const validInviteCode = inviteCodes.find(code => 
  code.code === inviteCode && 
  code.isActive && 
  !code.usedBy &&
  new Date(code.expiresAt) > new Date()
)
```

## 📋 使用流程

### 管理员操作流程
1. **登录管理员账户**
2. **生成邀请码**：为新的商家生成邀请码
3. **管理商家**：查看和设置商家权限
4. **监控活动**：查看所有活动数据
5. **数据统计**：分析平台运营数据

### 商家注册流程
1. **获取邀请码**：从管理员处获得邀请码
2. **注册账户**：使用邀请码注册商家账户
3. **创建活动**：在限制范围内创建活动
4. **管理票务**：管理自己的活动和票务

## 🚀 部署说明

### 环境变量
```bash
# 管理员系统使用localStorage存储
# 无需额外环境变量配置
```

### 数据存储
- **管理员数据**：硬编码在代码中
- **商家数据**：存储在localStorage
- **邀请码数据**：存储在localStorage
- **活动数据**：存储在localStorage

## 🔍 故障排除

### 常见问题
1. **无法登录管理员账户**
   - 检查默认凭据是否正确
   - 确认管理员账户存在

2. **邀请码无效**
   - 检查邀请码是否过期
   - 确认邀请码是否已被使用

3. **商家注册失败**
   - 验证邀请码格式
   - 检查邮箱是否已注册

### 调试步骤
1. 检查浏览器控制台错误
2. 验证localStorage数据
3. 确认API路由正常工作
4. 检查网络连接状态

## 📈 扩展功能

### 未来可扩展功能
- **多级管理员**：不同权限级别的管理员
- **审计日志**：管理员操作记录
- **数据导出**：导出商家和活动数据
- **通知系统**：重要事件通知
- **API接口**：外部系统集成

现在您的系统已经集成了完整的管理员功能！🎉

