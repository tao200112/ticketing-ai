# æ´»åŠ¨åˆ›å»ºä¿å­˜å¤±è´¥é—®é¢˜ä¿®å¤æ€»ç»“

## ğŸ› é—®é¢˜è¯Šæ–­

### åŸå§‹é—®é¢˜
- **ç—‡çŠ¶**: æ´»åŠ¨åˆ›å»ºä¿å­˜å¤±è´¥ï¼Œè¿”å›500é”™è¯¯
- **é”™è¯¯ä¿¡æ¯**: "Failed to create event"
- **å½±å“**: ç®¡ç†å‘˜æ— æ³•åˆ›å»ºæ´»åŠ¨ï¼Œæ´»åŠ¨ä¸æ˜¾ç¤ºåœ¨ä¸»é¡µå’Œæ´»åŠ¨é¡µé¢

### æ ¹æœ¬åŸå› 
1. **æ•°æ®åº“è¡¨ç»“æ„ä¸åŒ¹é…**: ä»£ç ä¸­ä½¿ç”¨çš„å­—æ®µåä¸æ•°æ®åº“å®é™…å­—æ®µåä¸ä¸€è‡´
2. **å­—æ®µåé”™è¯¯**: 
   - ä»£ç ä½¿ç”¨: `end_date`, `location`, `start_date`
   - æ•°æ®åº“å®é™…: `end_at`, `venue_name`, `start_at`
3. **çŠ¶æ€çº¦æŸé”™è¯¯**: ä½¿ç”¨äº†ä¸å­˜åœ¨çš„çŠ¶æ€å€¼ `'active'`ï¼Œå®é™…åº”è¯¥æ˜¯ `'draft'`

## âœ… ä¿®å¤è¿‡ç¨‹

### 1. é”™è¯¯è¯Šæ–­
```bash
# æµ‹è¯•æ´»åŠ¨åˆ›å»ºAPI
âŒ æ´»åŠ¨åˆ›å»ºå¤±è´¥: 500 {"error":"Failed to create event","details":"Could not find the 'end_date' column of 'events' in the schema cache"}
```

### 2. å­—æ®µåä¿®å¤
**ä¿®å¤å‰:**
```typescript
.insert({
  title,
  description,
  start_date: startDate,    // âŒ é”™è¯¯å­—æ®µå
  end_date: endDate,       // âŒ é”™è¯¯å­—æ®µå
  location,                // âŒ é”™è¯¯å­—æ®µå
  merchant_id: finalMerchantId,
  status: 'active'         // âŒ é”™è¯¯çŠ¶æ€å€¼
})
```

**ä¿®å¤å:**
```typescript
.insert({
  title,
  description,
  start_at: startDate,     // âœ… æ­£ç¡®å­—æ®µå
  end_at: endDate,         // âœ… æ­£ç¡®å­—æ®µå
  venue_name: location,    // âœ… æ­£ç¡®å­—æ®µå
  max_attendees: maxAttendees || null,
  merchant_id: finalMerchantId,
  status: 'draft'          // âœ… æ­£ç¡®çŠ¶æ€å€¼
})
```

### 3. æ•°æ®æ ¼å¼è½¬æ¢ä¿®å¤
**æ´»åŠ¨APIæ•°æ®æ ¼å¼è½¬æ¢:**
```typescript
const formattedEvents = events.map(event => ({
  id: event.id,
  name: event.title,
  description: event.description,
  start_date: event.start_at,    // âœ… ä½¿ç”¨æ­£ç¡®å­—æ®µ
  end_date: event.end_at,        // âœ… ä½¿ç”¨æ­£ç¡®å­—æ®µ
  location: event.venue_name,   // âœ… ä½¿ç”¨æ­£ç¡®å­—æ®µ
  max_attendees: event.max_attendees,
  poster_url: event.poster_url,
  merchant: event.merchants,
  created_at: event.created_at
}))
```

### 4. çŠ¶æ€è¿‡æ»¤ä¿®å¤
**æ´»åŠ¨APIçŠ¶æ€è¿‡æ»¤:**
```typescript
// ä¿®å¤å‰: åªæŸ¥è¯¢ 'active' çŠ¶æ€
.eq('status', 'active')

// ä¿®å¤å: æŸ¥è¯¢ 'active' å’Œ 'draft' çŠ¶æ€
.in('status', ['active', 'draft'])
```

## ğŸ§ª æµ‹è¯•ç»“æœ

### æ´»åŠ¨åˆ›å»ºæµ‹è¯•
```bash
ğŸ§ª æµ‹è¯•æ´»åŠ¨åˆ›å»ºåŠŸèƒ½
ğŸ“Š å“åº”çŠ¶æ€: 200
âœ… æ´»åŠ¨åˆ›å»ºæˆåŠŸï¼
ğŸ“‹ è¿”å›æ•°æ®:
{
  "success": true,
  "event": {
    "id": "5ea23895-2504-47c4-80c3-86b82e5a9868",
    "merchant_id": "4e55af8e-b07a-4410-80ee-b7ada4a58e00",
    "title": "æµ‹è¯•æ´»åŠ¨",
    "description": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ´»åŠ¨æè¿°",
    "start_at": "2024-12-31T00:00:00+00:00",
    "end_at": "2024-12-31T00:00:00+00:00",
    "venue_name": "æµ‹è¯•åœ°ç‚¹",
    "max_attendees": 100,
    "status": "draft",
    "created_at": "2025-10-24T23:18:44.165556+00:00"
  }
}
```

## ğŸ“Š å½“å‰çŠ¶æ€

### âœ… å·²ä¿®å¤
- **æ´»åŠ¨åˆ›å»º**: æˆåŠŸä¿å­˜åˆ°æ•°æ®åº“
- **å­—æ®µæ˜ å°„**: ä½¿ç”¨æ­£ç¡®çš„æ•°æ®åº“å­—æ®µå
- **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨æ­£ç¡®çš„çŠ¶æ€å€¼
- **æ•°æ®æ ¼å¼**: ç»Ÿä¸€çš„å‰åç«¯æ•°æ®æ ¼å¼

### ğŸ”„ è¿›è¡Œä¸­
- **æ´»åŠ¨æ˜¾ç¤º**: éœ€è¦éªŒè¯æ´»åŠ¨åœ¨ä¸»é¡µå’Œæ´»åŠ¨é¡µé¢çš„æ˜¾ç¤º
- **æ•°æ®åŒæ­¥**: éœ€è¦ç¡®è®¤æ•°æ®å®æ—¶æ›´æ–°

### ğŸ“‹ ä¸‹ä¸€æ­¥
1. **éªŒè¯æ´»åŠ¨æ˜¾ç¤º**: æ£€æŸ¥æ´»åŠ¨æ˜¯å¦åœ¨ä¸»é¡µå’Œæ´»åŠ¨é¡µé¢æ­£ç¡®æ˜¾ç¤º
2. **æµ‹è¯•å®Œæ•´æµç¨‹**: ä»åˆ›å»ºåˆ°æ˜¾ç¤ºçš„å®Œæ•´æµç¨‹
3. **ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ**: ç¡®ä¿æ•°æ®å®æ—¶æ›´æ–°

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ•°æ®åº“è¡¨ç»“æ„
```sql
-- eventsè¡¨å®é™…ç»“æ„
CREATE TABLE events (
  id UUID PRIMARY KEY,
  title TEXT,
  description TEXT,
  start_at TIMESTAMPTZ,      -- ä¸æ˜¯ start_date
  end_at TIMESTAMPTZ,        -- ä¸æ˜¯ end_date
  venue_name TEXT,           -- ä¸æ˜¯ location
  max_attendees INTEGER,
  status TEXT DEFAULT 'draft', -- é»˜è®¤çŠ¶æ€æ˜¯ 'draft'
  merchant_id UUID,
  created_at TIMESTAMPTZ,
  updated_at TIMESTAMPTZ
);
```

### APIä¿®å¤è¦ç‚¹
1. **å­—æ®µåæ˜ å°„**: ç¡®ä¿ä½¿ç”¨æ•°æ®åº“å®é™…çš„å­—æ®µå
2. **çŠ¶æ€å€¼**: ä½¿ç”¨æ•°æ®åº“æ”¯æŒçš„çŠ¶æ€å€¼
3. **æ•°æ®è½¬æ¢**: ç»Ÿä¸€å‰åç«¯æ•°æ®æ ¼å¼
4. **é”™è¯¯å¤„ç†**: æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

## ğŸ¯ é¢„æœŸç»“æœ

ä¿®å¤å®Œæˆåï¼Œç³»ç»Ÿå°†å®ç°ï¼š

### ç®¡ç†å‘˜åŠŸèƒ½
- **æ´»åŠ¨åˆ›å»º**: æˆåŠŸåˆ›å»ºå¹¶ä¿å­˜æ´»åŠ¨åˆ°æ•°æ®åº“
- **æ•°æ®ç®¡ç†**: æŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤æ´»åŠ¨
- **çŠ¶æ€ç®¡ç†**: ç®¡ç†æ´»åŠ¨çŠ¶æ€ï¼ˆdraft/activeï¼‰

### ç”¨æˆ·ç•Œé¢
- **ä¸»é¡µæ˜¾ç¤º**: åˆ›å»ºçš„æ´»åŠ¨åœ¨ä¸»é¡µå¯è§
- **æ´»åŠ¨é¡µé¢**: å®Œæ•´çš„æ´»åŠ¨åˆ—è¡¨å’Œè¯¦æƒ…
- **å®æ—¶æ›´æ–°**: æ•°æ®å˜åŒ–å®æ—¶åæ˜ 

### æ•°æ®æµ
- **åˆ›å»º**: ç®¡ç†å‘˜åˆ›å»ºæ´»åŠ¨ â†’ ä¿å­˜åˆ°æ•°æ®åº“
- **æ˜¾ç¤º**: æ•°æ®åº“æ´»åŠ¨ â†’ ä¸»é¡µå’Œæ´»åŠ¨é¡µé¢æ˜¾ç¤º
- **åŒæ­¥**: æ•°æ®å˜åŒ–å®æ—¶åŒæ­¥

ç°åœ¨æ´»åŠ¨åˆ›å»ºåŠŸèƒ½å·²ç»å®Œå…¨ä¿®å¤ï¼Œå¯ä»¥æˆåŠŸä¿å­˜åˆ°æ•°æ®åº“ï¼
